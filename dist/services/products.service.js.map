{"version":3,"sources":["../../src/services/products.service.ts"],"sourcesContent":["import DB from '@/databases';\r\nimport { CreateProductDto } from '@/dtos/products.dto';\r\nimport { HttpException } from '@/exceptions/HttpException';\r\nimport { Product } from '@/models/products.model';\r\nimport { isEmpty } from '@/utils/util';\r\n\r\nclass ProductService {\r\n  public products = DB.Products;\r\n\r\n  public async findAllProduct(): Promise<Product[]> {\r\n    const allProduct: Product[] = await this.products.findAll({\r\n      order: [\r\n        ['id', 'DESC'],\r\n        ['created_at', 'DESC'],\r\n      ],\r\n    });\r\n    return allProduct;\r\n  }\r\n\r\n  public async findProductById(productId: number): Promise<Product> {\r\n    if (isEmpty(productId)) throw new HttpException(400, 'ProductId is empty');\r\n\r\n    const findProduct: Product = await this.products.findByPk(productId);\r\n    if (!findProduct) throw new HttpException(409, \"Product doesn't exist\");\r\n\r\n    return findProduct;\r\n  }\r\n\r\n  public async createProduct(productData: CreateProductDto): Promise<Product> {\r\n    if (isEmpty(productData)) throw new HttpException(400, 'productData is empty');\r\n\r\n    const findProduct: Product = await this.products.findOne({\r\n      where: { name: productData.name },\r\n    });\r\n    if (findProduct)\r\n      throw new HttpException(409, `This product name ${productData.name} is already exists`);\r\n\r\n    const createProductData: Product = await this.products.create({\r\n      ...productData,\r\n    });\r\n    return createProductData;\r\n  }\r\n\r\n  public async updateProduct(productId: number, productData: CreateProductDto): Promise<Product> {\r\n    if (isEmpty(productData)) throw new HttpException(400, 'productData is empty');\r\n\r\n    const findProduct: Product = await this.products.findByPk(productId);\r\n    if (!findProduct) throw new HttpException(409, \"Product doesn't exist\");\r\n\r\n    await this.products.update({ ...productData }, { where: { id: productId } });\r\n\r\n    const updateProduct: Product = await this.products.findByPk(productId);\r\n    return updateProduct;\r\n  }\r\n\r\n  public async deleteProduct(productId: number): Promise<Product> {\r\n    if (isEmpty(productId)) throw new HttpException(400, \"Product doesn't existId\");\r\n\r\n    const findProduct: Product = await this.products.findByPk(productId);\r\n    if (!findProduct) throw new HttpException(409, \"Product doesn't exist\");\r\n\r\n    await this.products.destroy({ where: { id: productId } });\r\n\r\n    return findProduct;\r\n  }\r\n}\r\n\r\nexport default ProductService;\r\n"],"names":["ProductService","findAllProduct","allProduct","products","findAll","order","findProductById","productId","isEmpty","HttpException","findProduct","findByPk","createProduct","productData","findOne","where","name","createProductData","create","updateProduct","update","id","deleteProduct","destroy","DB","Products"],"mappings":"AAAA;;;;+BAmEA;;aAAA;;kDAnEe;+BAEe;sBAEN;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAExB,IAAA,AAAMA,iBAAN,MAAMA;IAGJ,MAAaC,iBAAqC;QAChD,MAAMC,aAAwB,MAAM,IAAI,CAACC,QAAQ,CAACC,OAAO,CAAC;YACxDC,OAAO;gBACL;oBAAC;oBAAM;iBAAO;gBACd;oBAAC;oBAAc;iBAAO;aACvB;QACH;QACA,OAAOH;IACT;IAEA,MAAaI,gBAAgBC,SAAiB,EAAoB;QAChE,IAAIC,IAAAA,aAAO,EAACD,YAAY,MAAM,IAAIE,4BAAa,CAAC,KAAK,sBAAsB;QAE3E,MAAMC,cAAuB,MAAM,IAAI,CAACP,QAAQ,CAACQ,QAAQ,CAACJ;QAC1D,IAAI,CAACG,aAAa,MAAM,IAAID,4BAAa,CAAC,KAAK,yBAAyB;QAExE,OAAOC;IACT;IAEA,MAAaE,cAAcC,WAA6B,EAAoB;QAC1E,IAAIL,IAAAA,aAAO,EAACK,cAAc,MAAM,IAAIJ,4BAAa,CAAC,KAAK,wBAAwB;QAE/E,MAAMC,cAAuB,MAAM,IAAI,CAACP,QAAQ,CAACW,OAAO,CAAC;YACvDC,OAAO;gBAAEC,MAAMH,YAAYG,IAAI;YAAC;QAClC;QACA,IAAIN,aACF,MAAM,IAAID,4BAAa,CAAC,KAAK,CAAC,kBAAkB,EAAEI,YAAYG,IAAI,CAAC,kBAAkB,CAAC,EAAE;QAE1F,MAAMC,oBAA6B,MAAM,IAAI,CAACd,QAAQ,CAACe,MAAM,CAAC,kBACzDL;QAEL,OAAOI;IACT;IAEA,MAAaE,cAAcZ,SAAiB,EAAEM,WAA6B,EAAoB;QAC7F,IAAIL,IAAAA,aAAO,EAACK,cAAc,MAAM,IAAIJ,4BAAa,CAAC,KAAK,wBAAwB;QAE/E,MAAMC,cAAuB,MAAM,IAAI,CAACP,QAAQ,CAACQ,QAAQ,CAACJ;QAC1D,IAAI,CAACG,aAAa,MAAM,IAAID,4BAAa,CAAC,KAAK,yBAAyB;QAExE,MAAM,IAAI,CAACN,QAAQ,CAACiB,MAAM,CAAC,kBAAKP,cAAe;YAAEE,OAAO;gBAAEM,IAAId;YAAU;QAAE;QAE1E,MAAMY,gBAAyB,MAAM,IAAI,CAAChB,QAAQ,CAACQ,QAAQ,CAACJ;QAC5D,OAAOY;IACT;IAEA,MAAaG,cAAcf,SAAiB,EAAoB;QAC9D,IAAIC,IAAAA,aAAO,EAACD,YAAY,MAAM,IAAIE,4BAAa,CAAC,KAAK,2BAA2B;QAEhF,MAAMC,cAAuB,MAAM,IAAI,CAACP,QAAQ,CAACQ,QAAQ,CAACJ;QAC1D,IAAI,CAACG,aAAa,MAAM,IAAID,4BAAa,CAAC,KAAK,yBAAyB;QAExE,MAAM,IAAI,CAACN,QAAQ,CAACoB,OAAO,CAAC;YAAER,OAAO;gBAAEM,IAAId;YAAU;QAAE;QAEvD,OAAOG;IACT;;aAzDOP,WAAWqB,kBAAE,CAACC,QAAQ;;AA0D/B;MAEA,WAAezB"}